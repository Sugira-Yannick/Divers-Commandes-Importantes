<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Commandes Windows - Base de Connaissances Compl√®te</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&family=JetBrains+Mono:wght@400;500&display=swap" rel="stylesheet">
    <style>
        /* === COULEURS EXACTES === */
        :root {
            --primary-color: #2c3e50;
            --secondary-color: #3498db;
            --accent-color: #e74c3c;
            --bg-color: #ecf0f1;
            --card-color: #ffffff;
            --text-color: #2c3e50;
            --text-light: #7f8c8d;
            --border-color: #bdc3c7;
            --success-color: #27ae60;
            --warning-color: #f39c12;
            --danger-color: #e74c3c;
            --sidebar-width: 280px;
            --border-radius: 8px;
            --shadow: 0 2px 5px rgba(0,0,0,0.1);
            --shadow-lg: 0 5px 15px rgba(0,0,0,0.1);
            --transition: all 0.3s ease;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Inter', sans-serif;
            background-color: var(--bg-color);
            color: var(--text-color);
            line-height: 1.6;
        }

        /* === LAYOUT === */
        .container {
            display: flex;
            min-height: 100vh;
        }

        /* === SIDEBAR === */
        .sidebar {
            width: var(--sidebar-width);
            background-color: var(--card-color);
            border-right: 1px solid var(--border-color);
            position: fixed;
            height: 100vh;
            overflow-y: auto;
            padding: 20px;
        }

        .logo {
            display: flex;
            align-items: center;
            gap: 12px;
            margin-bottom: 30px;
            padding-bottom: 20px;
            border-bottom: 1px solid var(--border-color);
        }

        .logo-icon {
            background: linear-gradient(135deg, var(--primary-color), var(--secondary-color));
            color: white;
            width: 40px;
            height: 40px;
            border-radius: var(--border-radius);
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 20px;
        }

        .logo h1 {
            font-size: 1.4rem;
            font-weight: 700;
            color: var(--text-color);
        }

        .logo span {
            color: var(--secondary-color);
        }

        .search-box {
            position: relative;
            margin-bottom: 20px;
        }

        .search-box input {
            width: 100%;
            padding: 12px 15px 12px 45px;
            border-radius: var(--border-radius);
            border: 1px solid var(--border-color);
            background-color: var(--bg-color);
            font-size: 0.9rem;
        }

        .search-box i {
            position: absolute;
            left: 15px;
            top: 50%;
            transform: translateY(-50%);
            color: var(--text-light);
        }

        .nav-title {
            font-size: 0.8rem;
            text-transform: uppercase;
            letter-spacing: 0.5px;
            color: var(--text-light);
            margin: 20px 0 10px;
            font-weight: 600;
        }

        .nav-links {
            list-style: none;
        }

        .nav-links li {
            margin-bottom: 5px;
        }

        .nav-links a {
            display: flex;
            align-items: center;
            gap: 10px;
            padding: 10px 15px;
            border-radius: var(--border-radius);
            color: var(--text-color);
            text-decoration: none;
            font-weight: 500;
        }

        .nav-links a:hover,
        .nav-links a.active {
            background-color: rgba(52, 152, 219, 0.1);
            color: var(--secondary-color);
        }

        .back-to-main {
            margin-top: 30px;
            padding-top: 20px;
            border-top: 1px solid var(--border-color);
        }

        .back-link {
            display: flex;
            align-items: center;
            gap: 10px;
            color: var(--secondary-color);
            text-decoration: none;
            font-weight: 600;
            padding: 10px 15px;
            background-color: rgba(52, 152, 219, 0.1);
            border-radius: var(--border-radius);
        }

        /* === MAIN CONTENT === */
        .main-content {
            flex: 1;
            margin-left: var(--sidebar-width);
            padding: 20px;
        }

        /* === HEADER === */
        .header {
            background-color: var(--card-color);
            padding: 25px;
            border-radius: var(--border-radius);
            margin-bottom: 30px;
            box-shadow: var(--shadow);
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .header h1 {
            font-size: 1.8rem;
            margin-bottom: 5px;
        }

        .header p {
            color: var(--text-light);
        }

        .header-actions {
            display: flex;
            gap: 10px;
        }

        .btn {
            padding: 10px 20px;
            border-radius: var(--border-radius);
            border: none;
            font-weight: 600;
            cursor: pointer;
            display: inline-flex;
            align-items: center;
            gap: 8px;
            font-size: 0.9rem;
        }

        .btn-outline {
            background-color: transparent;
            color: var(--text-color);
            border: 1px solid var(--border-color);
        }

        .btn-outline:hover {
            background-color: rgba(52, 152, 219, 0.1);
            color: var(--secondary-color);
        }

        .btn-primary {
            background-color: var(--secondary-color);
            color: white;
        }

        .btn-primary:hover {
            background-color: #2980b9;
        }

        /* === SECTIONS === */
        .section {
            margin-bottom: 40px;
        }

        .section-header {
            display: flex;
            align-items: center;
            gap: 10px;
            margin-bottom: 20px;
            padding-bottom: 10px;
            border-bottom: 2px solid rgba(52, 152, 219, 0.2);
        }

        .section-header h2 {
            font-size: 1.4rem;
            color: var(--primary-color);
        }

        .section-tag {
            background-color: rgba(52, 152, 219, 0.1);
            color: var(--secondary-color);
            padding: 4px 12px;
            border-radius: 20px;
            font-size: 0.8rem;
            font-weight: 600;
            margin-left: auto;
        }

        /* === CATEGORIES PLIABLES === */
        .category {
            background-color: var(--card-color);
            border-radius: var(--border-radius);
            margin-bottom: 20px;
            box-shadow: var(--shadow);
            border-left: 5px solid var(--secondary-color);
            overflow: hidden;
        }

        .category-header {
            padding: 18px 20px;
            background-color: rgba(52, 152, 219, 0.05);
            border-bottom: 1px solid var(--border-color);
            cursor: pointer;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .category-header:hover {
            background-color: rgba(52, 152, 219, 0.1);
        }

        .category-header h3 {
            font-size: 1.1rem;
            font-weight: 600;
            color: var(--text-color);
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .category-header i {
            color: var(--secondary-color);
            transition: transform 0.3s ease;
        }

        .category-header i.rotated {
            transform: rotate(180deg);
        }

        .category-content {
            max-height: 5000px;
            overflow: hidden;
            transition: max-height 0.5s ease, opacity 0.3s ease;
            opacity: 1;
        }

        .category-content.collapsed {
            max-height: 0;
            opacity: 0;
        }

        /* === COMMANDES === */
        .command-item {
            padding: 25px;
            border-bottom: 1px solid var(--border-color);
        }

        .command-item:last-child {
            border-bottom: none;
        }

        /* M√©tadonn√©es */
        .command-meta {
            display: flex;
            flex-wrap: wrap;
            gap: 15px;
            margin-bottom: 20px;
            padding-bottom: 15px;
            border-bottom: 1px solid var(--border-color);
        }

        .meta-item {
            display: flex;
            align-items: center;
            gap: 8px;
            font-size: 0.85rem;
        }

        .risk-low {
            color: var(--success-color);
            font-weight: 600;
            background-color: rgba(39, 174, 96, 0.1);
            padding: 3px 10px;
            border-radius: 20px;
        }

        .risk-medium {
            color: var(--warning-color);
            font-weight: 600;
            background-color: rgba(243, 156, 18, 0.1);
            padding: 3px 10px;
            border-radius: 20px;
        }

        .risk-high {
            color: var(--danger-color);
            font-weight: 600;
            background-color: rgba(231, 76, 60, 0.1);
            padding: 3px 10px;
            border-radius: 20px;
        }

        .category-tag {
            background-color: rgba(52, 152, 219, 0.1);
            color: var(--secondary-color);
            padding: 3px 10px;
            border-radius: 20px;
            font-size: 0.8rem;
            font-weight: 600;
        }

        .time-tag {
            background-color: rgba(155, 89, 182, 0.1);
            color: #9b59b6;
            padding: 3px 10px;
            border-radius: 20px;
            font-size: 0.8rem;
        }

        /* Code block */
        .command-code {
            background-color: #2c3e50;
            color: #ecf0f1;
            padding: 20px;
            border-radius: var(--border-radius);
            font-family: 'JetBrains Mono', monospace;
            font-size: 0.9rem;
            line-height: 1.5;
            margin: 20px 0;
            overflow-x: auto;
            border-left: 4px solid var(--secondary-color);
        }

        .command-code .comment {
            color: #95a5a6;
            font-style: italic;
        }

        .command-code .cmd {
            color: #3498db;
            font-weight: 500;
        }

        /* Notes */
        .command-notes {
            margin-top: 20px;
            padding-top: 20px;
            border-top: 1px solid var(--border-color);
        }

        .note {
            margin-bottom: 15px;
            padding-left: 25px;
            position: relative;
        }

        .note:before {
            content: "";
            position: absolute;
            left: 0;
            top: 6px;
            width: 8px;
            height: 8px;
            border-radius: 50%;
        }

        .note-when:before { background-color: var(--success-color); }
        .note-warning:before { background-color: var(--warning-color); }
        .note-test:before { background-color: var(--secondary-color); }
        .note-scenario:before { background-color: var(--accent-color); }

        .note-title {
            font-weight: 600;
            margin-bottom: 5px;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        /* Structure AD */
        .ad-structure {
            background-color: #f8f9fa;
            border: 1px solid var(--border-color);
            border-radius: var(--border-radius);
            padding: 25px;
            margin: 20px 0;
            font-family: 'JetBrains Mono', monospace;
            font-size: 0.9rem;
            line-height: 1.8;
            overflow-x: auto;
        }

        .ad-item {
            margin-left: 20px;
            position: relative;
        }

        .ad-item:before {
            content: "‚îú‚îÄ‚îÄ ";
            position: absolute;
            left: -20px;
            color: var(--text-light);
        }

        .ad-item.last:before {
            content: "‚îî‚îÄ‚îÄ ";
        }

        .ad-comment {
            color: var(--text-light);
            font-style: italic;
            margin-left: 10px;
        }

        /* === FOOTER === */
        .footer {
            text-align: center;
            padding: 40px 0;
            color: var(--text-light);
            border-top: 1px solid var(--border-color);
            margin-top: 40px;
        }

        /* === RESPONSIVE === */
        @media (max-width: 768px) {
            .sidebar {
                position: relative;
                width: 100%;
                height: auto;
            }
            
            .main-content {
                margin-left: 0;
            }
            
            .container {
                flex-direction: column;
            }
            
            .header {
                flex-direction: column;
                gap: 15px;
                text-align: center;
            }
            
            .header-actions {
                width: 100%;
                justify-content: center;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <!-- SIDEBAR -->
        <nav class="sidebar">
            <div class="logo">
                <div class="logo-icon">
                    <i class="fab fa-windows"></i>
                </div>
                <div>
                    <h1>Commandes <span>Windows</span></h1>
                    <small style="color: var(--text-light); font-size: 0.8rem;">Base de connaissances compl√®te</small>
                </div>
            </div>

            <div class="search-box">
                <i class="fas fa-search"></i>
                <input type="text" id="searchInput" placeholder="Rechercher...">
            </div>

            <div class="nav-title">Navigation</div>
            <ul class="nav-links">
                <li><a href="#server" class="active"><i class="fas fa-server"></i> Windows Server</a></li>
                <li><a href="#powershell"><i class="fas fa-terminal"></i> PowerShell</a></li>
                <li><a href="#network"><i class="fas fa-network-wired"></i> R√©seau & Pare-feu</a></li>
                <li><a href="#ad"><i class="fas fa-users-cog"></i> Active Directory</a></li>
                <li><a href="#dhcp-dns"><i class="fas fa-dharmachakra"></i> DHCP & DNS</a></li>
                <li><a href="#file"><i class="fas fa-folder"></i> Fichiers & Partages</a></li>
                <li><a href="#gpo"><i class="fas fa-sliders-h"></i> GPO & Strat√©gies</a></li>
                <li><a href="#services"><i class="fas fa-cogs"></i> Services & R√¥les</a></li>
                <li><a href="#remote"><i class="fas fa-laptop-house"></i> Administration √† distance</a></li>
                <li><a href="#utils"><i class="fas fa-tools"></i> Utilitaires</a></li>
                <li><a href="#scripts"><i class="fas fa-code"></i> Scripts Complets</a></li>
            </ul>

            <div class="back-to-main">
                <a href="https://sugira-yannick.github.io/Divers-Commandes-Importantes/" class="back-link" target="_blank">
                    <i class="fas fa-arrow-left"></i>
                    Retour au site principal
                </a>
            </div>
        </nav>

        <!-- MAIN CONTENT -->
        <main class="main-content">
            <!-- HEADER -->
            <header class="header">
                <div>
                    <h1>Commandes Windows Server & PowerShell Compl√®tes</h1>
                    <p>Collection exhaustive de commandes pour l'administration Windows - TP AFCI</p>
                </div>
                <div class="header-actions">
                    <button class="btn btn-outline" id="expandAllBtn">
                        <i class="fas fa-expand-alt"></i> Tout d√©plier
                    </button>
                    <button class="btn btn-outline" id="collapseAllBtn">
                        <i class="fas fa-compress-alt"></i> Tout replier
                    </button>
                    <button class="btn btn-primary" onclick="window.print()">
                        <i class="fas fa-print"></i> Imprimer
                    </button>
                </div>
            </header>

            <!-- SECTION WINDOWS SERVER -->
            <section id="server" class="section">
                <div class="section-header">
                    <h2><i class="fas fa-server"></i> Windows Server</h2>
                    <span class="section-tag">Administration</span>
                </div>

                <!-- Cat√©gorie : Configuration Serveur -->
                <div class="category">
                    <div class="category-header" onclick="toggleCategory(this)">
                        <h3><i class="fas fa-cog"></i> Configuration Serveur</h3>
                        <i class="fas fa-chevron-down"></i>
                    </div>
                    <div class="category-content">
                        <!-- COMMANDE 1 -->
                        <div class="command-item">
                            <div class="command-meta">
                                <span class="risk-medium">RISQUE MOYEN</span>
                                <span class="category-tag">CONFIGURATION</span>
                                <span class="time-tag">‚è±Ô∏è 30 secondes</span>
                            </div>
                            
                            <h3>Renommer un serveur Windows</h3>
                            
                            <pre class="command-code"># Renommer un serveur et red√©marrer
Rename-Computer -NewName "[NOM_SERVEUR]" -Force -Restart

# Renommer sans red√©marrer
Rename-Computer -NewName "[NOM_SERVEUR]" -Force</pre>
                            
                            <div class="command-notes">
                                <div class="note note-when">
                                    <div class="note-title">üéØ Quand utiliser</div>
                                    <p>Renommage d'un serveur apr√®s l'installation ou lors d'une restructuration</p>
                                </div>
                                <div class="note note-warning">
                                    <div class="note-title">‚ö†Ô∏è Attention</div>
                                    <p>Le renommage n√©cessite un red√©marrage pour √™tre effectif</p>
                                </div>
                                <div class="note note-test">
                                    <div class="note-title">‚úÖ Test de succ√®s</div>
                                    <p>Commande `hostname` affiche le nouveau nom</p>
                                </div>
                            </div>
                        </div>
                        
                        <!-- COMMANDE 2 -->
                        <div class="command-item">
                            <div class="command-meta">
                                <span class="risk-low">RISQUE FAIBLE</span>
                                <span class="category-tag">R√âSEAU</span>
                                <span class="time-tag">‚è±Ô∏è 15 secondes</span>
                            </div>
                            
                            <h3>Configurer une adresse IP statique</h3>
                            
                            <pre class="command-code"># Configurer une IP statique
New-NetIPAddress -InterfaceIndex [ID_INTERFACE] `
    -IPAddress [ADRESSE_IP] `
    -PrefixLength [MASQUE] `
    -DefaultGateway [PASSERELLE]

# Exemple concret
New-NetIPAddress -InterfaceIndex 2 `
    -IPAddress 192.168.1.10 `
    -PrefixLength 24 `
    -DefaultGateway 192.168.1.1</pre>
                            
                            <div class="command-notes">
                                <div class="note note-when">
                                    <div class="note-title">üéØ Quand utiliser</div>
                                    <p>Configuration manuelle d'adresse IP pour les serveurs</p>
                                </div>
                                <div class="note note-warning">
                                    <div class="note-title">‚ö†Ô∏è Attention</div>
                                    <p>V√©rifier que l'adresse IP n'est pas d√©j√† utilis√©e</p>
                                </div>
                                <div class="note note-test">
                                    <div class="note-title">‚úÖ Test de succ√®s</div>
                                    <p>`ping [ADRESSE_IP]` fonctionne depuis un autre poste</p>
                                </div>
                            </div>
                        </div>

                        <!-- COMMANDE 3 -->
                        <div class="command-item">
                            <div class="command-meta">
                                <span class="risk-low">RISQUE FAIBLE</span>
                                <span class="category-tag">R√âSEAU</span>
                                <span class="time-tag">‚è±Ô∏è 5 secondes</span>
                            </div>
                            
                            <h3>Configurer interface r√©seau avec DHCP</h3>
                            
                            <pre class="command-code"># Activer DHCP sur une interface
Set-NetIPInterface -InterfaceAlias "Ethernet" -Dhcp Enabled

# D√©sactiver DHCP
Set-NetIPInterface -InterfaceAlias "Ethernet" -Dhcp Disabled

# Configurer DNS client
Set-DnsClientServerAddress -InterfaceIndex 2 `
    -ServerAddresses @("8.8.8.8", "8.8.4.4")</pre>
                            
                            <div class="command-notes">
                                <div class="note note-when">
                                    <div class="note-title">üéØ Quand utiliser</div>
                                    <p>Configuration automatique d'adresse IP ou modification DNS</p>
                                </div>
                                <div class="note note-warning">
                                    <div class="note-title">‚ö†Ô∏è Attention</div>
                                    <p>DHCP peut attribuer une IP diff√©rente √† chaque red√©marrage</p>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Cat√©gorie : R√¥les & Fonctionnalit√©s -->
                <div class="category">
                    <div class="category-header" onclick="toggleCategory(this)">
                        <h3><i class="fas fa-layer-group"></i> R√¥les & Fonctionnalit√©s</h3>
                        <i class="fas fa-chevron-down"></i>
                    </div>
                    <div class="category-content">
                        <!-- COMMANDE 1 -->
                        <div class="command-item">
                            <div class="command-meta">
                                <span class="risk-high">RISQUE √âLEV√â</span>
                                <span class="category-tag">ACTIVE DIRECTORY</span>
                                <span class="time-tag">‚è±Ô∏è 10-30 minutes</span>
                            </div>
                            
                            <h3>Installer AD Domain Services</h3>
                            
                            <pre class="command-code"># Installer AD DS avec les outils
Install-WindowsFeature AD-Domain-Services -IncludeManagementTools

# Promouvoir en contr√¥leur de domaine
Install-ADDSForest -DomainName "[NOM_DOMAINE]" `
    -DomainNetbiosName "[NETBIOS_NAME]" `
    -InstallDNS `
    -Force</pre>
                            
                            <div class="command-notes">
                                <div class="note note-when">
                                    <div class="note-title">üéØ Quand utiliser</div>
                                    <p>Cr√©ation d'un nouveau domaine Active Directory</p>
                                </div>
                                <div class="note note-warning">
                                    <div class="note-title">‚ö†Ô∏è Attention</div>
                                    <p>Op√©ration irr√©versible, red√©marrage requis</p>
                                </div>
                                <div class="note note-test">
                                    <div class="note-title">‚úÖ Test de succ√®s</div>
                                    <p>`Get-ADDomain` retourne les informations du domaine</p>
                                </div>
                            </div>
                        </div>

                        <!-- COMMANDE 2 -->
                        <div class="command-item">
                            <div class="command-meta">
                                <span class="risk-medium">RISQUE MOYEN</span>
                                <span class="category-tag">SERVEUR FICHIERS</span>
                                <span class="time-tag">‚è±Ô∏è 2 minutes</span>
                            </div>
                            
                            <h3>Installer Serveur de Fichiers</h3>
                            
                            <pre class="command-code"># Installer le r√¥le Serveur de Fichiers
Install-WindowsFeature FS-FileServer -IncludeManagementTools

# V√©rifier l'installation
Get-WindowsFeature FS-FileServer | Select-Object Name, Installed</pre>
                            
                            <div class="command-notes">
                                <div class="note note-when">
                                    <div class="note-title">üéØ Quand utiliser</div>
                                    <p>Cr√©ation d'un serveur de fichiers pour partages r√©seau</p>
                                </div>
                                <div class="note note-test">
                                    <div class="note-title">‚úÖ Test de succ√®s</div>
                                    <p>La fonctionnalit√© appara√Æt comme install√©e</p>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </section>

            <!-- SECTION POWERSHELL -->
            <section id="powershell" class="section">
                <div class="section-header">
                    <h2><i class="fas fa-terminal"></i> PowerShell</h2>
                    <span class="section-tag">Scripting</span>
                </div>

                <!-- Cat√©gorie : Configuration R√©seau -->
                <div class="category">
                    <div class="category-header" onclick="toggleCategory(this)">
                        <h3><i class="fas fa-wifi"></i> Configuration R√©seau</h3>
                        <i class="fas fa-chevron-down"></i>
                    </div>
                    <div class="category-content">
                        <!-- COMMANDE 1 -->
                        <div class="command-item">
                            <div class="command-meta">
                                <span class="risk-low">RISQUE FAIBLE</span>
                                <span class="category-tag">DIAGNOSTIC</span>
                                <span class="time-tag">‚è±Ô∏è 2 secondes</span>
                            </div>
                            
                            <h3>Lister les interfaces r√©seau</h3>
                            
                            <pre class="command-code"># Lister toutes les interfaces
Get-NetAdapter

# Voir la configuration compl√®te
Get-NetIPConfiguration

# Adresses IP d√©taill√©es
Get-NetIPAddress -AddressFamily IPv4 | Sort-Object InterfaceIndex</pre>
                            
                            <div class="command-notes">
                                <div class="note note-when">
                                    <div class="note-title">üéØ Quand utiliser</div>
                                    <p>V√©rification de la configuration r√©seau</p>
                                </div>
                                <div class="note note-warning">
                                    <div class="note-title">‚ö†Ô∏è Attention</div>
                                    <p>Certaines interfaces peuvent √™tre virtuelles</p>
                                </div>
                                <div class="note note-test">
                                    <div class="note-title">‚úÖ Test de succ√®s</div>
                                    <p>Affichage coh√©rent des interfaces actives</p>
                                </div>
                            </div>
                        </div>

                        <!-- COMMANDE 2 -->
                        <div class="command-item">
                            <div class="command-meta">
                                <span class="risk-low">RISQUE FAIBLE</span>
                                <span class="category-tag">DIAGNOSTIC</span>
                                <span class="time-tag">‚è±Ô∏è 5 secondes</span>
                            </div>
                            
                            <h3>Gestion avanc√©e des adresses IP</h3>
                            
                            <pre class="command-code"># Supprimer une adresse IP existante
Get-NetIPAddress -InterfaceAlias "Ethernet 2" | Remove-NetIPAddress -Confirm:$false

# Ajouter une nouvelle adresse IP
New-NetIPAddress -InterfaceAlias "Ethernet 2" -IPAddress 172.16.2.1 -PrefixLength 28

# V√©rifier les configurations IP
Get-NetIPConfiguration | Select-Object InterfaceAlias, InterfaceIndex, IPv4Address</pre>
                            
                            <div class="command-notes">
                                <div class="note note-when">
                                    <div class="note-title">üéØ Quand utiliser</div>
                                    <p>Modification ou correction de configuration IP</p>
                                </div>
                                <div class="note note-warning">
                                    <div class="note-title">‚ö†Ô∏è Attention</div>
                                    <p>La suppression d'adresse IP peut couper la connectivit√©</p>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Cat√©gorie : Gestion Syst√®me -->
                <div class="category">
                    <div class="category-header" onclick="toggleCategory(this)">
                        <h3><i class="fas fa-desktop"></i> Gestion Syst√®me</h3>
                        <i class="fas fa-chevron-down"></i>
                    </div>
                    <div class="category-content">
                        <!-- COMMANDE 1 -->
                        <div class="command-item">
                            <div class="command-meta">
                                <span class="risk-low">RISQUE FAIBLE</span>
                                <span class="category-tag">SYST√àME</span>
                                <span class="time-tag">‚è±Ô∏è 10 secondes</span>
                            </div>
                            
                            <h3>Gestion des services Windows</h3>
                            
                            <pre class="command-code"># D√©marrer un service
Start-Service -Name "[NOM_SERVICE]"

# Arr√™ter un service
Stop-Service -Name "[NOM_SERVICE]" -Force

# Configurer d√©marrage automatique
Set-Service -Name "[NOM_SERVICE]" -StartupType Automatic

# Voir services en cours
Get-Service | Where-Object {$_.Status -eq "Running"} | Select-Object Name, DisplayName</pre>
                            
                            <div class="command-notes">
                                <div class="note note-when">
                                    <div class="note-title">üéØ Quand utiliser</div>
                                    <p>Maintenance, red√©marrage de services, configuration</p>
                                </div>
                                <div class="note note-warning">
                                    <div class="note-title">‚ö†Ô∏è Attention</div>
                                    <p>Certains services critiques ne doivent pas √™tre arr√™t√©s</p>
                                </div>
                                <div class="note note-scenario">
                                    <div class="note-title">üö® Sc√©nario</div>
                                    <p>Service qui ne d√©marre pas, service bloqu√©</p>
                                </div>
                            </div>
                        </div>

                        <!-- COMMANDE 2 -->
                        <div class="command-item">
                            <div class="command-meta">
                                <span class="risk-low">RISQUE FAIBLE</span>
                                <span class="category-tag">SYST√àME</span>
                                <span class="time-tag">‚è±Ô∏è 5 secondes</span>
                            </div>
                            
                            <h3>Red√©marrer un serveur</h3>
                            
                            <pre class="command-code"># Red√©marrer imm√©diatement
Restart-Computer -Force

# Red√©marrer avec d√©lai (30 secondes)
Restart-Computer -Delay 30 -Force

# Red√©marrer un ordinateur distant
Restart-Computer -ComputerName "SRV-01" -Force</pre>
                            
                            <div class="command-notes">
                                <div class="note note-when">
                                    <div class="note-title">üéØ Quand utiliser</div>
                                    <p>Application de mises √† jour, r√©solution de probl√®mes</p>
                                </div>
                                <div class="note note-warning">
                                    <div class="note-title">‚ö†Ô∏è Attention</div>
                                    <p>Pr√©venir les utilisateurs avant red√©marrage en production</p>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </section>

            <!-- SECTION R√âSEAU & PARE-FEU -->
            <section id="network" class="section">
                <div class="section-header">
                    <h2><i class="fas fa-network-wired"></i> R√©seau & Pare-feu</h2>
                    <span class="section-tag">Connectivit√©</span>
                </div>

                <!-- Cat√©gorie : Pare-feu Windows -->
                <div class="category">
                    <div class="category-header" onclick="toggleCategory(this)">
                        <h3><i class="fas fa-fire"></i> Pare-feu Windows</h3>
                        <i class="fas fa-chevron-down"></i>
                    </div>
                    <div class="category-content">
                        <!-- COMMANDE 1 -->
                        <div class="command-item">
                            <div class="command-meta">
                                <span class="risk-high">RISQUE √âLEV√â</span>
                                <span class="category-tag">S√âCURIT√â</span>
                                <span class="time-tag">‚è±Ô∏è 5 secondes</span>
                            </div>
                            
                            <h3>Activer/d√©sactiver le pare-feu</h3>
                            
                            <pre class="command-code"># D√©sactiver temporairement le pare-feu
Set-NetFirewallProfile -Profile Domain,Public,Private -Enabled False

# Activer le pare-feu
Set-NetFirewallProfile -Profile Domain,Public,Private -Enabled True

# V√©rifier l'√©tat du pare-feu
Get-NetFirewallProfile | Select-Object Name, Enabled</pre>
                            
                            <div class="command-notes">
                                <div class="note note-when">
                                    <div class="note-title">üéØ Quand utiliser</div>
                                    <p>Tests de connectivit√©, d√©pannage r√©seau</p>
                                </div>
                                <div class="note note-warning">
                                    <div class="note-title">‚ö†Ô∏è Attention</div>
                                    <p>Ne pas laisser le pare-feu d√©sactiv√© en production</p>
                                </div>
                                <div class="note note-scenario">
                                    <div class="note-title">üö® Sc√©nario</div>
                                    <p>Impossible de ping un serveur, ports bloqu√©s</p>
                                </div>
                            </div>
                        </div>

                        <!-- COMMANDE 2 -->
                        <div class="command-item">
                            <div class="command-meta">
                                <span class="risk-medium">RISQUE MOYEN</span>
                                <span class="category-tag">S√âCURIT√â</span>
                                <span class="time-tag">‚è±Ô∏è 10 secondes</span>
                            </div>
                            
                            <h3>Cr√©er des r√®gles de pare-feu</h3>
                            
                            <pre class="command-code"># Autoriser ICMP (ping) pour un r√©seau sp√©cifique
New-NetFirewallRule `
  -DisplayName "Allow ICMPv4 LAN" `
  -Direction Inbound `
  -Protocol ICMPv4 `
  -ICMPType 8 `
  -RemoteAddress 192.168.1.0/24 `
  -Profile Any `
  -Action Allow

# Autoriser le trafic forward√©
New-NetFirewallRule `
  -DisplayName "Allow Forwarded Traffic" `
  -Direction Inbound `
  -Action Allow `
  -Profile Any `
  -InterfaceAlias "Ethernet 2" `
  -Protocol Any</pre>
                            
                            <div class="command-notes">
                                <div class="note note-when">
                                    <div class="note-title">üéØ Quand utiliser</div>
                                    <p>Ouverture de ports pour applications, routage</p>
                                </div>
                                <div class="note note-warning">
                                    <div class="note-title">‚ö†Ô∏è Attention</div>
                                    <p>Limiter les r√®gles aux adresses IP n√©cessaires uniquement</p>
                                </div>
                            </div>
                        </div>

                        <!-- COMMANDE 3 -->
                        <div class="command-item">
                            <div class="command-meta">
                                <span class="risk-low">RISQUE FAIBLE</span>
                                <span class="category-tag">S√âCURIT√â</span>
                                <span class="time-tag">‚è±Ô∏è 5 secondes</span>
                            </div>
                            
                            <h3>Gestion des r√®gles de pare-feu</h3>
                            
                            <pre class="command-code"># Supprimer une r√®gle par son nom
Remove-NetFirewallRule -DisplayName "Allow ICMPv4 Anywhere"

# Supprimer plusieurs r√®gles
Get-NetFirewallRule -Profile Private | Remove-NetFirewallRule

# Activer des groupes de r√®gles
Enable-NetFirewallRule -DisplayGroup "File and Printer Sharing"
Enable-NetFirewallRule -DisplayGroup "Remote Service Management"</pre>
                            
                            <div class="command-notes">
                                <div class="note note-when">
                                    <div class="note-title">üéØ Quand utiliser</div>
                                    <p>Nettoyage de r√®gles obsol√®tes, activation de fonctionnalit√©s</p>
                                </div>
                                <div class="note note-test">
                                    <div class="note-title">‚úÖ Test de succ√®s</div>
                                    <p>Les services n√©cessaires sont accessibles</p>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Cat√©gorie : Routage & NAT -->
                <div class="category">
                    <div class="category-header" onclick="toggleCategory(this)">
                        <h3><i class="fas fa-route"></i> Routage & NAT</h3>
                        <i class="fas fa-chevron-down"></i>
                    </div>
                    <div class="category-content">
                        <!-- COMMANDE 1 -->
                        <div class="command-item">
                            <div class="command-meta">
                                <span class="risk-high">RISQUE √âLEV√â</span>
                                <span class="category-tag">R√âSEAU</span>
                                <span class="time-tag">‚è±Ô∏è 30 secondes</span>
                            </div>
                            
                            <h3>Configuration NAT</h3>
                            
                            <pre class="command-code"># Cr√©er une configuration NAT
New-NetNat -Name "[NOM_NAT]" `
    -InternalIPInterfaceAddressPrefix "[RESEAU_CIDR]"

# Exemple pour r√©seau interne
New-NetNat -Name "LAN-NAT" `
    -InternalIPInterfaceAddressPrefix "192.168.1.0/24"

# Voir configurations existantes
Get-NetNat

# Supprimer une configuration
Remove-NetNat -Name "[NOM_NAT]" -Confirm:$false</pre>
                            
                            <div class="command-notes">
                                <div class="note note-when">
                                    <div class="note-title">üéØ Quand utiliser</div>
                                    <p>Partage de connexion Internet, masquage d'adresses</p>
                                </div>
                                <div class="note note-warning">
                                    <div class="note-title">‚ö†Ô∏è Attention</div>
                                    <p>Configuration complexe, bien tester</p>
                                </div>
                                <div class="note note-test">
                                    <div class="note-title">‚úÖ Test de succ√®s</div>
                                    <p>Les clients du r√©seau interne peuvent acc√©der √† Internet</p>
                                </div>
                            </div>
                        </div>

                        <!-- COMMANDE 2 -->
                        <div class="command-item">
                            <div class="command-meta">
                                <span class="risk-medium">RISQUE MOYEN</span>
                                <span class="category-tag">R√âSEAU</span>
                                <span class="time-tag">‚è±Ô∏è 15 secondes</span>
                            </div>
                            
                            <h3>Gestion du routage IP</h3>
                            
                            <pre class="command-code"># Activer/d√©sactiver le forwarding IP
Set-NetIPInterface -InterfaceAlias "Ethernet 2" -Forwarding Enabled
Set-NetIPInterface -InterfaceAlias "Ethernet" -Forwarding Disabled

# Ajouter une route statique
New-NetRoute -DestinationPrefix "172.16.0.0/24" `
    -NextHop "172.16.2.140" `
    -InterfaceIndex 2 `
    -PolicyStore PersistentStore

# V√©rifier les routes
Get-NetRoute -AddressFamily IPv4 | Where-Object {$_.DestinationPrefix -ne "0.0.0.0/0"} | Format-Table</pre>
                            
                            <div class="command-notes">
                                <div class="note note-when">
                                    <div class="note-title">üéØ Quand utiliser</div>
                                    <p>Configuration de routeurs, connexion entre r√©seaux</p>
                                </div>
                                <div class="note note-warning">
                                    <div class="note-title">‚ö†Ô∏è Attention</div>
                                    <p>Les routes incorrectes peuvent couper la connectivit√©</p>
                                </div>
                            </div>
                        </div>

                        <!-- COMMANDE 3 -->
                        <div class="command-item">
                            <div class="command-meta">
                                <span class="risk-medium">RISQUE MOYEN</span>
                                <span class="category-tag">R√âSEAU</span>
                                <span class="time-tag">‚è±Ô∏è 10 secondes</span>
                            </div>
                            
                            <h3>Configuration DHCP Relay</h3>
                            
                            <pre class="command-code"># Installer DHCP Relay (via netsh)
netsh routing ip relay install

# D√©clarer le serveur DHCP
netsh routing ip relay add dhcpserver 172.16.2.1

# Activer DHCP Relay sur une interface
netsh routing ip relay add interface "Ethernet 2"</pre>
                            
                            <div class="command-notes">
                                <div class="note note-when">
                                    <div class="note-title">üéØ Quand utiliser</div>
                                    <p>Relayer les requ√™tes DHCP entre r√©seaux</p>
                                </div>
                                <div class="note note-warning">
                                    <div class="note-title">‚ö†Ô∏è Attention</div>
                                    <p>N√©cessite une configuration de pare-feu appropri√©e</p>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </section>

            <!-- SECTION ACTIVE DIRECTORY -->
            <section id="ad" class="section">
                <div class="section-header">
                    <h2><i class="fas fa-users-cog"></i> Active Directory</h2>
                    <span class="section-tag">Domain Services</span>
                </div>

                <!-- Structure AD -->
                <div class="command-item">
                    <div class="command-meta">
                        <span class="risk-low">RISQUE FAIBLE</span>
                        <span class="category-tag">STRUCTURE</span>
                        <span class="time-tag">‚è±Ô∏è Planification</span>
                    </div>
                    
                    <h3>Structure AD</h3>
                    
                    <div class="ad-structure">
HP-Network
‚îÇ
‚îú‚îÄ‚îÄ Ordinateurs
‚îÇ   ‚îú‚îÄ‚îÄ Administration
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ Direction
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ Comptabilite
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ Secretariat
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ IT
‚îÇ   ‚îî‚îÄ‚îÄ Salles-Formation
‚îÇ       ‚îú‚îÄ‚îÄ AIS
‚îÇ       ‚îú‚îÄ‚îÄ TSSR
‚îÇ       ‚îú‚îÄ‚îÄ DevOps
‚îÇ       ‚îî‚îÄ‚îÄ Assistance-Enfance
‚îÇ
‚îú‚îÄ‚îÄ Utilisateurs
‚îÇ   ‚îú‚îÄ‚îÄ Direction
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ fabrice.iraduha@afci.lab
‚îÇ   ‚îú‚îÄ‚îÄ Comptabilite
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ claire.muyizere@afci.lab
‚îÇ   ‚îú‚îÄ‚îÄ Secretariat
‚îÇ   ‚îú‚îÄ‚îÄ AIS
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ erci.nkuru@afci.lab
‚îÇ   ‚îú‚îÄ‚îÄ TSSR
‚îÇ   ‚îú‚îÄ‚îÄ DevOps
‚îÇ   ‚îî‚îÄ‚îÄ Assistance-Enfance
‚îÇ
‚îú‚îÄ‚îÄ _Admins
‚îÇ   ‚îú‚îÄ‚îÄ IT
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ yannick.sugira@afci.lab
‚îÇ   ‚îî‚îÄ‚îÄ Direction
‚îÇ       ‚îú‚îÄ‚îÄ fabrice.iraguha@afci.lab
‚îÇ
‚îú‚îÄ‚îÄ Groupes
‚îÇ   ‚îú‚îÄ‚îÄ Globaux
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ Metiers
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ GG_Direction
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ GG_Comptabilite
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ GG_Secretariat
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ GG_AIS
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ GG_TSSR
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ GG_DevOps
‚îÇ   ‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ GG_Assistance_Enfance
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ Specifiques
‚îÇ   ‚îÇ       ‚îú‚îÄ‚îÄ GG_TSSR_ReadOnly
‚îÇ   ‚îÇ       ‚îú‚îÄ‚îÄ GG_DevOps_Formateurs
‚îÇ   ‚îÇ       ‚îî‚îÄ‚îÄ GG_Stagiaires
‚îÇ   ‚îî‚îÄ‚îÄ Locaux-Domaine
‚îÇ       ‚îú‚îÄ‚îÄ Fichiers
‚îÇ       ‚îÇ   ‚îú‚îÄ‚îÄ DL_FS_Commun_RW
‚îÇ       ‚îÇ   ‚îú‚îÄ‚îÄ DL_FS_Commun_R
‚îÇ       ‚îÇ   ‚îú‚îÄ‚îÄ DL_FS_Administration_RW
‚îÇ       ‚îÇ   ‚îú‚îÄ‚îÄ DL_FS_Administration_R
‚îÇ       ‚îÇ   ‚îú‚îÄ‚îÄ DL_FS_Formation_RW
‚îÇ       ‚îÇ   ‚îî‚îÄ‚îÄ DL_FS_Formation_R
‚îÇ       ‚îî‚îÄ‚îÄ GPO
‚îÇ           ‚îú‚îÄ‚îÄ DL_GPO_TSSR
‚îÇ           ‚îú‚îÄ‚îÄ DL_GPO_DevOps
‚îÇ           ‚îú‚îÄ‚îÄ DL_GPO_AIS
‚îÇ           ‚îú‚îÄ‚îÄ DL_GPO_Direction
‚îÇ           ‚îú‚îÄ‚îÄ DL_GPO_Secretariat
‚îÇ           ‚îú‚îÄ‚îÄ DL_GPO_Comptabilite
‚îÇ           ‚îî‚îÄ‚îÄ DL_GPO_Assistance-Enfance
‚îÇ
‚îî‚îÄ‚îÄ Serveurs
    ‚îú‚îÄ‚îÄ SRV-01 Lille
    ‚îú‚îÄ‚îÄ SRV-02 Lille
    ‚îî‚îÄ‚îÄ SRV-03 Arras
                    </div>
                    
                    <div class="command-notes">
                        <div class="note note-when">
                            <div class="note-title">üéØ Objectif de la structure</div>
                            <p>Organisation logique pour gestion fluide et application simplifi√©e des GPO</p>
                        </div>
                        <div class="note note-test">
                            <div class="note-title">‚úÖ Bonnes pratiques</div>
                            <p>S√©paration administration/utilisateurs, regroupement par m√©tier</p>
                        </div>
                    </div>
                </div>

                <!-- Cat√©gorie : Cr√©ation Structure AD -->
                <div class="category">
                    <div class="category-header" onclick="toggleCategory(this)">
                        <h3><i class="fas fa-sitemap"></i> Cr√©ation Structure AD</h3>
                        <i class="fas fa-chevron-down"></i>
                    </div>
                    <div class="category-content">
                        <!-- COMMANDE 1 -->
                        <div class="command-item">
                            <div class="command-meta">
                                <span class="risk-medium">RISQUE MOYEN</span>
                                <span class="category-tag">STRUCTURE</span>
                                <span class="time-tag">‚è±Ô∏è 10 minutes</span>
                            </div>
                            
                            <h3>Cr√©er les Unit√©s d'Organisation (OU)</h3>
                            
                            <pre class="command-code"># OU principales
$DomainDN = "DC=afci,DC=lab"
New-ADOrganizationalUnit -Name "AFCI-Formation" -Path $DomainDN -ProtectedFromAccidentalDeletion $true
New-ADOrganizationalUnit -Name "Ordinateurs" -Path "OU=AFCI-Formation,$DomainDN"
New-ADOrganizationalUnit -Name "Utilisateurs" -Path "OU=AFCI-Formation,$DomainDN"
New-ADOrganizationalUnit -Name "_Admins" -Path "OU=AFCI-Formation,$DomainDN"
New-ADOrganizationalUnit -Name "Groupes" -Path "OU=AFCI-Formation,$DomainDN"
New-ADOrganizationalUnit -Name "Serveurs" -Path "OU=AFCI-Formation,$DomainDN"

# Sous-OU Ordinateurs
New-ADOrganizationalUnit -Name "Administration" -Path "OU=Ordinateurs,OU=AFCI-Formation,$DomainDN"
New-ADOrganizationalUnit -Name "Salles-Formation" -Path "OU=Ordinateurs,OU=AFCI-Formation,$DomainDN"</pre>
                            
                            <div class="command-notes">
                                <div class="note note-when">
                                    <div class="note-title">üéØ Quand utiliser</div>
                                    <p>Initialisation de la structure Active Directory</p>
                                </div>
                                <div class="note note-warning">
                                    <div class="note-title">‚ö†Ô∏è Attention</div>
                                    <p>Planifier la structure avant cr√©ation</p>
                                </div>
                            </div>
                        </div>

                        <!-- COMMANDE 2 -->
                        <div class="command-item">
                            <div class="command-meta">
                                <span class="risk-medium">RISQUE MOYEN</span>
                                <span class="category-tag">STRUCTURE</span>
                                <span class="time-tag">‚è±Ô∏è 5 minutes</span>
                            </div>
                            
                            <h3>Cr√©er les groupes AD</h3>
                            
                            <pre class="command-code"># Cr√©ation de groupes pour les partages
$DLGroups = @(
    "LD-FS-Commun-R",
    "LD-FS-Commun-RW",
    "LD-FS-Commun-F",
    "LD-FS-Formation-R",
    "LD-FS-Formation-RW",
    "LD-FS-Formation-F",
    "LD-FS-Administration-RW",
    "LD-FS-Administration-F"
)

foreach ($group in $DLGroups) {
    New-ADGroup `
        -Name $group `
        -GroupScope DomainLocal `
        -GroupCategory Security `
        -Path "OU=Groupes,DC=afci,DC=lab"
}</pre>
                            
                            <div class="command-notes">
                                <div class="note note-when">
                                    <div class="note-title">üéØ Quand utiliser</div>
                                    <p>Cr√©ation des groupes pour gestion des permissions</p>
                                </div>
                                <div class="note note-test">
                                    <div class="note-title">‚úÖ Test de succ√®s</div>
                                    <p>Les groupes apparaissent dans l'OU Groupes</p>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Cat√©gorie : Utilisateurs & Groupes -->
                <div class="category">
                    <div class="category-header" onclick="toggleCategory(this)">
                        <h3><i class="fas fa-user-plus"></i> Utilisateurs & Groupes</h3>
                        <i class="fas fa-chevron-down"></i>
                    </div>
                    <div class="category-content">
                        <!-- COMMANDE 1 -->
                        <div class="command-item">
                            <div class="command-meta">
                                <span class="risk-low">RISQUE FAIBLE</span>
                                <span class="category-tag">UTILISATEURS</span>
                                <span class="time-tag">‚è±Ô∏è 10 secondes</span>
                            </div>
                            
                            <h3>Cr√©er un utilisateur AD</h3>
                            
                            <pre class="command-code"># Cr√©er un nouvel utilisateur
New-ADUser -Name "[NOM_COMPLET]" `
    -GivenName "[PRENOM]" `
    -Surname "[NOM]" `
    -SamAccountName "[LOGIN]" `
    -UserPrincipalName "[LOGIN]@[DOMAINE]" `
    -Enabled $true `
    -AccountPassword (ConvertTo-SecureString "[MDP]" -AsPlainText -Force)</pre>
                            
                            <div class="command-notes">
                                <div class="note note-when">
                                    <div class="note-title">üéØ Quand utiliser</div>
                                    <p>Cr√©ation de comptes utilisateurs en masse</p>
                                </div>
                                <div class="note note-warning">
                                    <div class="note-title">‚ö†Ô∏è Attention</div>
                                    <p>Le mot de passe doit respecter la politique de s√©curit√©</p>
                                </div>
                                <div class="note note-test">
                                    <div class="note-title">‚úÖ Test de succ√®s</div>
                                    <p>L'utilisateur peut se connecter au domaine</p>
                                </div>
                            </div>
                        </div>

                        <!-- COMMANDE 2 -->
                        <div class="command-item">
                            <div class="command-meta">
                                <span class="risk-low">RISQUE FAIBLE</span>
                                <span class="category-tag">GROUPES</span>
                                <span class="time-tag">‚è±Ô∏è 5 secondes</span>
                            </div>
                            
                            <h3>Gestion des membres de groupes</h3>
                            
                            <pre class="command-code"># Ajouter des membres √† un groupe
Add-ADGroupMember -Identity "LD-FS-Commun-R" `
    -Members "GG-Direction","GG-Comptabilite","GG-Secretariat"

# Retirer un membre
Remove-ADGroupMember -Identity "LD-FS-Commun-R" `
    -Members "GG-Secretariat" -Confirm:$false

# V√©rifier les membres
Get-ADGroupMember -Identity "LD-FS-Commun-R" | Select-Object Name</pre>
                            
                            <div class="command-notes">
                                <div class="note note-when">
                                    <div class="note-title">üéØ Quand utiliser</div>
                                    <p>Configuration des permissions par groupes</p>
                                </div>
                                <div class="note note-test">
                                    <div class="note-title">‚úÖ Test de succ√®s</div>
                                    <p>Les permissions s'appliquent correctement</p>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Cat√©gorie : DC R√©pliqu√© -->
                <div class="category">
                    <div class="category-header" onclick="toggleCategory(this)">
                        <h3><i class="fas fa-sync-alt"></i> DC R√©pliqu√©</h3>
                        <i class="fas fa-chevron-down"></i>
                    </div>
                    <div class="category-content">
                        <!-- COMMANDE 1 -->
                        <div class="command-item">
                            <div class="command-meta">
                                <span class="risk-high">RISQUE √âLEV√â</span>
                                <span class="category-tag">R√âPLICATION</span>
                                <span class="time-tag">‚è±Ô∏è 10-30 minutes</span>
                            </div>
                            
                            <h3>Promouvoir en DC r√©pliqu√©</h3>
                            
                            <pre class="command-code"># Promouvoir un serveur en DC r√©pliqu√©
Install-ADDSDomainController `
    -DomainName "afci.lab" `
    -SafeModeAdministratorPassword $SafeModePwd `
    -Credential $PromotionCreds `
    -InstallDns `
    -NoGlobalCatalog:$false `
    -SiteName "Default-First-Site-Name" `
    -ReplicationSourceDC "SRV-01.afci.lab" `
    -CreateDnsDelegation:$false `
    -NoRebootOnCompletion:$false `
    -Force</pre>
                            
                            <div class="command-notes">
                                <div class="note note-when">
                                    <div class="note-title">üéØ Quand utiliser</div>
                                    <p>Ajout d'un contr√¥leur de domaine suppl√©mentaire</p>
                                </div>
                                <div class="note note-warning">
                                    <div class="note-title">‚ö†Ô∏è Attention</div>
                                    <p>Op√©ration irr√©versible, n√©cessite un red√©marrage</p>
                                </div>
                                <div class="note note-test">
                                    <div class="note-title">‚úÖ Test de succ√®s</div>
                                    <p>`repadmin /replsummary` montre une r√©plication saine</p>
                                </div>
                            </div>
                        </div>

                        <!-- COMMANDE 2 -->
                        <div class="command-item">
                            <div class="command-meta">
                                <span class="risk-low">RISQUE FAIBLE</span>
                                <span class="category-tag">DIAGNOSTIC</span>
                                <span class="time-tag">‚è±Ô∏è 5 secondes</span>
                            </div>
                            
                            <h3>V√©rifier la r√©plication AD</h3>
                            
                            <pre class="command-code"># V√©rifier l'√©tat de r√©plication
repadmin /replsummary

# V√©rifier les informations du DC
Get-ADDomainController -Identity "SRV-03" | Format-List *

# Tester la connectivit√© DNS
Resolve-DnsName afci.lab -Server 172.16.2.65</pre>
                            
                            <div class="command-notes">
                                <div class="note note-when">
                                    <div class="note-title">üéØ Quand utiliser</div>
                                    <p>Surveillance de la sant√© AD, d√©pannage</p>
                                </div>
                                <div class="note note-test">
                                    <div class="note-title">‚úÖ Test de succ√®s</div>
                                    <p>Aucune erreur dans le r√©sum√© de r√©plication</p>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </section>

            <!-- SECTION DHCP & DNS -->
            <section id="dhcp-dns" class="section">
                <div class="section-header">
                    <h2><i class="fas fa-dharmachakra"></i> DHCP & DNS</h2>
                    <span class="section-tag">Services R√©seau</span>
                </div>

                <!-- Cat√©gorie : Configuration DHCP -->
                <div class="category">
                    <div class="category-header" onclick="toggleCategory(this)">
                        <h3><i class="fas fa-bolt"></i> Configuration DHCP</h3>
                        <i class="fas fa-chevron-down"></i>
                    </div>
                    <div class="category-content">
                        <!-- COMMANDE 1 -->
                        <div class="command-item">
                            <div class="command-meta">
                                <span class="risk-medium">RISQUE MOYEN</span>
                                <span class="category-tag">DHCP</span>
                                <span class="time-tag">‚è±Ô∏è 30 secondes</span>
                            </div>
                            
                            <h3>Cr√©er un scope DHCP</h3>
                            
                            <pre class="command-code"># Cr√©er un scope DHCP
Add-DhcpServerv4Scope `
    -Name "[NOM_SCOPE]" `
    -StartRange [DEBUT_PLAGE] `
    -EndRange [FIN_PLAGE] `
    -SubnetMask [MASQUE_SOUS_RESEAU] `
    -State Active

# Exemple pour r√©seau 192.168.1.0/24
Add-DhcpServerv4Scope `
    -Name "Scope-Bureau" `
    -StartRange 192.168.1.100 `
    -EndRange 192.168.1.200 `
    -SubnetMask 255.255.255.0 `
    -State Active</pre>
                            
                            <div class="command-notes">
                                <div class="note note-when">
                                    <div class="note-title">üéØ Quand utiliser</div>
                                    <p>Mise en place d'une nouvelle plage DHCP</p>
                                </div>
                                <div class="note note-warning">
                                    <div class="note-title">‚ö†Ô∏è Attention</div>
                                    <p>√âviter les conflits avec les adresses statiques</p>
                                </div>
                                <div class="note note-test">
                                    <div class="note-title">‚úÖ Test de succ√®s</div>
                                    <p>Les clients re√ßoivent une adresse de la plage</p>
                                </div>
                            </div>
                        </div>

                        <!-- COMMANDE 2 -->
                        <div class="command-item">
                            <div class="command-meta">
                                <span class="risk-medium">RISQUE MOYEN</span>
                                <span class="category-tag">DHCP</span>
                                <span class="time-tag">‚è±Ô∏è 15 secondes</span>
                            </div>
                            
                            <h3>Configuration DHCP avanc√©e</h3>
                            
                            <pre class="command-code"># Autoriser le serveur DHCP dans AD
Add-DhcpServerInDC `
  -DnsName "SRV-DHCP.afci.local" `
  -IPAddress 172.16.2.1

# Configurer les options DHCP
Set-DhcpServerv4OptionValue `
  -ScopeId 192.168.0.0 `
  -Router 192.168.0.254 `
  -DnsServer 172.16.2.1 `
  -DnsDomain "afci.lab"

# Cr√©er une r√©servation IP
Add-DhcpServerv4Reservation `
  -ScopeId 192.168.0.0 `
  -IPAddress 192.168.0.1 `
  -ClientId "00-00-00-0B-00-00" `
  -Name "Reservation-PC-Admin"</pre>
                            
                            <div class="command-notes">
                                <div class="note note-when">
                                    <div class="note-title">üéØ Quand utiliser</div>
                                    <p>Configuration compl√®te du service DHCP</p>
                                </div>
                                <div class="note note-warning">
                                    <div class="note-title">‚ö†Ô∏è Attention</div>
                                    <p>V√©rifier les conflits d'adresses IP</p>
                                </div>
                            </div>
                        </div>

                        <!-- COMMANDE 3 -->
                        <div class="command-item">
                            <div class="command-meta">
                                <span class="risk-medium">RISQUE MOYEN</span>
                                <span class="category-tag">DHCP</span>
                                <span class="time-tag">‚è±Ô∏è 2 minutes</span>
                            </div>
                            
                            <h3>Configuration DHCP Failover</h3>
                            
                            <pre class="command-code"># Configuration du failover pour un scope
Add-DhcpServerv4Failover `
    -Name "Failover-Lille-Scope" `
    -ScopeId 172.16.0.0 `
    -PartnerServer "SRV-03.afci.lab" `
    -ComputerName "SRV-01.afci.lab" `
    -LoadBalancePercent 50 `
    -MaxClientLeadTime 01:00:00

# V√©rifier les scopes
Get-DhcpServerv4Scope -ComputerName "SRV-01.afci.lab"
Get-DhcpServerv4Scope -ComputerName "SRV-03.afci.lab"</pre>
                            
                            <div class="command-notes">
                                <div class="note note-when">
                                    <div class="note-title">üéØ Quand utiliser</div>
                                    <p>Mise en place de haute disponibilit√© DHCP</p>
                                </div>
                                <div class="note note-test">
                                    <div class="note-title">‚úÖ Test de succ√®s</div>
                                    <p>Les clients re√ßoivent des adresses m√™me si un serveur est down</p>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Cat√©gorie : Configuration DNS -->
                <div class="category">
                    <div class="category-header" onclick="toggleCategory(this)">
                        <h3><i class="fas fa-globe"></i> Configuration DNS</h3>
                        <i class="fas fa-chevron-down"></i>
                    </div>
                    <div class="category-content">
                        <!-- COMMANDE 1 -->
                        <div class="command-item">
                            <div class="command-meta">
                                <span class="risk-low">RISQUE FAIBLE</span>
                                <span class="category-tag">DNS</span>
                                <span class="time-tag">‚è±Ô∏è 10 secondes</span>
                            </div>
                            
                            <h3>Cr√©er des enregistrements DNS</h3>
                            
                            <pre class="command-code"># Ajouter un enregistrement A
Add-DnsServerResourceRecordA `
    -Name "srv04" `
    -ZoneName "afci.lab" `
    -IPv4Address "172.16.2.104"

# Ajouter un enregistrement CNAME
Add-DnsServerResourceRecordCName `
    -Name "www" `
    -HostNameAlias "srv01.afci.lab" `
    -ZoneName "afci.lab"

# V√©rifier les enregistrements
Get-DnsServerResourceRecord -ZoneName "afci.lab" -RRType A</pre>
                            
                            <div class="command-notes">
                                <div class="note note-when">
                                    <div class="note-title">üéØ Quand utiliser</div>
                                    <p>Configuration manuelle de DNS pour nouveaux serveurs</p>
                                </div>
                                <div class="note note-test">
                                    <div class="note-title">‚úÖ Test de succ√®s</div>
                                    <p>R√©solution DNS fonctionnelle pour le nouveau nom</p>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </section>

            <!-- SECTION FICHIERS & PARTAGES -->
            <section id="file" class="section">
                <div class="section-header">
                    <h2><i class="fas fa-folder"></i> Fichiers & Partages</h2>
                    <span class="section-tag">Partages SMB</span>
                </div>

                <!-- Cat√©gorie : Cr√©ation Partages -->
                <div class="category">
                    <div class="category-header" onclick="toggleCategory(this)">
                        <h3><i class="fas fa-share-alt"></i> Cr√©ation Partages</h3>
                        <i class="fas fa-chevron-down"></i>
                    </div>
                    <div class="category-content">
                        <!-- COMMANDE 1 -->
                        <div class="command-item">
                            <div class="command-meta">
                                <span class="risk-medium">RISQUE MOYEN</span>
                                <span class="category-tag">PARTAGE</span>
                                <span class="time-tag">‚è±Ô∏è 10 minutes</span>
                            </div>
                            
                            <h3>Cr√©er l'arborescence et les partages</h3>
                            
                            <pre class="command-code"># Cr√©ation de l'arborescence
New-Item -ItemType Directory -Path "C:\Shares\Commun" -Force
New-Item -ItemType Directory -Path "C:\Shares\Formation" -Force
New-Item -ItemType Directory -Path "C:\Shares\Administration" -Force

# Nettoyer les droits NTFS par d√©faut
$Folders = @("C:\Shares\Commun", "C:\Shares\Formation", "C:\Shares\Administration")
foreach ($folder in $Folders) {
    icacls $folder /inheritance:r
    icacls $folder /remove "Users"
}

# Attribution des droits NTFS
icacls "C:\Shares\Commun" /grant `
  "AFCI\LD-FS-Commun-F:(OI)(CI)(F)" `
  "AFCI\DL-FS-Commun-RW:(OI)(CI)(M)" `
  "AFCI\DL-FS-Commun-R:(OI)(CI)(RX)"</pre>
                            
                            <div class="command-notes">
                                <div class="note note-when">
                                    <div class="note-title">üéØ Quand utiliser</div>
                                    <p>Configuration initiale des partages de fichiers</p>
                                </div>
                                <div class="note note-warning">
                                    <div class="note-title">‚ö†Ô∏è Attention</div>
                                    <p>Les permissions NTFS sont cumulatives avec les permissions SMB</p>
                                </div>
                            </div>
                        </div>

                        <!-- COMMANDE 2 -->
                        <div class="command-item">
                            <div class="command-meta">
                                <span class="risk-medium">RISQUE MOYEN</span>
                                <span class="category-tag">PARTAGE</span>
                                <span class="time-tag">‚è±Ô∏è 5 minutes</span>
                            </div>
                            
                            <h3>Cr√©er les partages SMB</h3>
                            
                            <pre class="command-code"># Cr√©ation des partages SMB
New-SmbShare -Name "Commun$" `
  -Path "C:\Shares\Commun" `
  -ChangeAccess "AFCI\LD-FS-Commun-RW" `
  -ReadAccess "AFCI\LD-FS-Commun-R" `
  -FullAccess "AFCI\LD-FS-Administration-F"

New-SmbShare -Name "Formation$" `
  -Path "C:\Shares\Formation" `
  -ChangeAccess "AFCI\LD-FS-Formation-RW" `
  -ReadAccess "AFCI\LD-FS-Formation-R" `
  -FullAccess "AFCI\LD-FS-Administration-F"

# V√©rifier les partages
Get-SmbShareAccess Commun$
Get-SmbShareAccess Formation$</pre>
                            
                            <div class="command-notes">
                                <div class="note note-when">
                                    <div class="note-title">üéØ Quand utiliser</div>
                                    <p>Publication des dossiers en partages r√©seau</p>
                                </div>
                                <div class="note note-test">
                                    <div class="note-title">‚úÖ Test de succ√®s</div>
                                    <p>Acc√®s au partage depuis un client du domaine</p>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </section>

            <!-- SECTION GPO & STRAT√âGIES -->
            <section id="gpo" class="section">
                <div class="section-header">
                    <h2><i class="fas fa-sliders-h"></i> GPO & Strat√©gies</h2>
                    <span class="section-tag">Strat√©gies de groupe</span>
                </div>

                <!-- Cat√©gorie : Gestion GPO -->
                <div class="category">
                    <div class="category-header" onclick="toggleCategory(this)">
                        <h3><i class="fas fa-cogs"></i> Gestion GPO</h3>
                        <i class="fas fa-chevron-down"></i>
                    </div>
                    <div class="category-content">
                        <!-- COMMANDE 1 -->
                        <div class="command-item">
                            <div class="command-meta">
                                <span class="risk-medium">RISQUE MOYEN</span>
                                <span class="category-tag">GPO</span>
                                <span class="time-tag">‚è±Ô∏è 5 minutes</span>
                            </div>
                            
                            <h3>Cr√©er et lier une GPO</h3>
                            
                            <pre class="command-code"># Cr√©er une nouvelle GPO
New-GPO -Name "GPO-SEC-Windows-LAPS-Ordinateurs" `
    -Comment "Gestion automatique des mots de passe admin locaux via Windows LAPS"

# Lier la GPO √† une OU
New-GPLink `
    -Name "GPO-SEC-Windows-LAPS-Ordinateurs" `
    -Target "OU=Ordinateurs,DC=afci,DC=lab" `
    -LinkEnabled Yes

# V√©rifier les GPO
Get-GPO -All | Where-Object { $_.DisplayName -like "*LAPS*" }</pre>
                            
                            <div class="command-notes">
                                <div class="note note-when">
                                    <div class="note-title">üéØ Quand utiliser</div>
                                    <p>D√©ploiement de strat√©gies de s√©curit√©</p>
                                </div>
                                <div class="note note-warning">
                                    <div class="note-title">‚ö†Ô∏è Attention</div>
                                    <p>Les GPO peuvent affecter de nombreux ordinateurs</p>
                                </div>
                            </div>
                        </div>

                        <!-- COMMANDE 2 -->
                        <div class="command-item">
                            <div class="command-meta">
                                <span class="risk-medium">RISQUE MOYEN</span>
                                <span class="category-tag">GPO</span>
                                <span class="time-tag">‚è±Ô∏è 10 minutes</span>
                            </div>
                            
                            <h3>Configurer GPO via registre</h3>
                            
                            <pre class="command-code"># Configuration LAPS via registre
$LAPSRegistryKey = "HKLM\Software\Microsoft\Policies\LAPS"
$GPOName = "GPO-SEC-Windows-LAPS-Ordinateurs"

# Sauvegarde dans Active Directory
Set-GPRegistryValue -GpoName $GPOName -Key $LAPSRegistryKey `
    -ValueName "BackupDirectory" -Type DWord -Value 1

# Dur√©e de validit√© (30 jours)
Set-GPRegistryValue -GpoName $GPOName -Key $LAPSRegistryKey `
    -ValueName "PasswordAgeDays" -Type DWord -Value 30

# Longueur du mot de passe
Set-GPRegistryValue -GpoName $GPOName -Key $LAPSRegistryKey `
    -ValueName "PasswordLength" -Type DWord -Value 14</pre>
                            
                            <div class="command-notes">
                                <div class="note note-when">
                                    <div class="note-title">üéØ Quand utiliser</div>
                                    <p>Configuration avanc√©e de strat√©gies</p>
                                </div>
                                <div class="note note-test">
                                    <div class="note-title">‚úÖ Test de succ√®s</div>
                                    <p>Les param√®tres s'appliquent apr√®s `gpupdate /force`</p>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Cat√©gorie : Windows LAPS -->
                <div class="category">
                    <div class="category-header" onclick="toggleCategory(this)">
                        <h3><i class="fas fa-key"></i> Windows LAPS</h3>
                        <i class="fas fa-chevron-down"></i>
                    </div>
                    <div class="category-content">
                        <!-- COMMANDE 1 -->
                        <div class="command-item">
                            <div class="command-meta">
                                <span class="risk-high">RISQUE √âLEV√â</span>
                                <span class="category-tag">S√âCURIT√â</span>
                                <span class="time-tag">‚è±Ô∏è 15 minutes</span>
                            </div>
                            
                            <h3>D√©ploiement Windows LAPS</h3>
                            
                            <pre class="command-code"># Installer le module LAPS
Get-WindowsCapability -Name RSAT*LAPS* -Online
Add-WindowsCapability -Online -Name Rsat.Laps.Tools~~~~0.0.1.0
Import-Module LAPS

# Mise √† jour du sch√©ma AD (1 seule fois)
Update-LapsADSchema

# Autoriser les ordinateurs √† √©crire leur mot de passe
Set-LapsADComputerSelfPermission -Identity "OU=Ordinateurs,DC=afci,DC=lab"

# D√©l√©gation de lecture des mots de passe LAPS
Set-LapsADReadPasswordPermission `
    -Identity "OU=Ordinateurs,DC=afci,DC=lab" `
    -AllowedPrincipals "GG_IT_Admin"</pre>
                            
                            <div class="command-notes">
                                <div class="note note-when">
                                    <div class="note-title">üéØ Quand utiliser</div>
                                    <p>Mise en place de la gestion automatique des mots de passe admin locaux</p>
                                </div>
                                <div class="note note-warning">
                                    <div class="note-title">‚ö†Ô∏è Attention</div>
                                    <p>Op√©ration sensible n√©cessitant des droits d'administrateur d'entreprise</p>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </section>

            <!-- SECTION SERVICES & R√îLES -->
            <section id="services" class="section">
                <div class="section-header">
                    <h2><i class="fas fa-cogs"></i> Services & R√¥les</h2>
                    <span class="section-tag">Administration</span>
                </div>

                <!-- Cat√©gorie : RRAS & Routage -->
                <div class="category">
                    <div class="category-header" onclick="toggleCategory(this)">
                        <h3><i class="fas fa-route"></i> RRAS & Routage</h3>
                        <i class="fas fa-chevron-down"></i>
                    </div>
                    <div class="category-content">
                        <!-- COMMANDE 1 -->
                        <div class="command-item">
                            <div class="command-meta">
                                <span class="risk-high">RISQUE √âLEV√â</span>
                                <span class="category-tag">ROUTAGE</span>
                                <span class="time-tag">‚è±Ô∏è 5 minutes</span>
                            </div>
                            
                            <h3>Installer et configurer RRAS</h3>
                            
                            <pre class="command-code"># Installer le r√¥le Routage et Acc√®s √† distance
Install-WindowsFeature RemoteAccess, Routing -IncludeManagementTools

# Activer le service RRAS
Install-RemoteAccess -VpnType RoutingOnly

# D√©marrer et configurer le service
Set-Service RemoteAccess -StartupType Automatic
Start-Service RemoteAccess</pre>
                            
                            <div class="command-notes">
                                <div class="note note-when">
                                    <div class="note-title">üéØ Quand utiliser</div>
                                    <p>Configuration d'un serveur comme routeur</p>
                                </div>
                                <div class="note note-warning">
                                    <div class="note-title">‚ö†Ô∏è Attention</div>
                                    <p>N√©cessite un red√©marrage apr√®s installation</p>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Cat√©gorie : Gestion √† Distance -->
                <div class="category">
                    <div class="category-header" onclick="toggleCategory(this)">
                        <h3><i class="fas fa-laptop-house"></i> Gestion √† Distance</h3>
                        <i class="fas fa-chevron-down"></i>
                    </div>
                    <div class="category-content">
                        <!-- COMMANDE 1 -->
                        <div class="command-item">
                            <div class="command-meta">
                                <span class="risk-medium">RISQUE MOYEN</span>
                                <span class="category-tag">ADMINISTRATION</span>
                                <span class="time-tag">‚è±Ô∏è 15 secondes</span>
                            </div>
                            
                            <h3>Configurer Remote Desktop</h3>
                            
                            <pre class="command-code"># Activer Remote Desktop
Set-ItemProperty -Path "HKLM:\\System\\CurrentControlSet\\Control\\Terminal Server" `
                 -Name "fDenyTSConnections" -Value 0

# Activer les r√®gles de pare-feu pour RDP
Enable-NetFirewallRule -DisplayGroup "Remote Desktop"

# Ajouter un utilisateur aux utilisateurs RDP
Add-LocalGroupMember -Group "Remote Desktop Users" -Member "[NOM_UTILISATEUR]"</pre>
                            
                            <div class="command-notes">
                                <div class="note note-when">
                                    <div class="note-title">üéØ Quand utiliser</div>
                                    <p>Acc√®s √† distance √† un serveur Windows</p>
                                </div>
                                <div class="note note-warning">
                                    <div class="note-title">‚ö†Ô∏è Attention</div>
                                    <p>S√©curiser RDP avec NLA et utilisateurs limit√©s</p>
                                </div>
                                <div class="note note-test">
                                    <div class="note-title">‚úÖ Test de succ√®s</div>
                                    <p>Connexion RDP r√©ussie</p>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Cat√©gorie : IPAM -->
                <div class="category">
                    <div class="category-header" onclick="toggleCategory(this)">
                        <h3><i class="fas fa-map"></i> IPAM</h3>
                        <i class="fas fa-chevron-down"></i>
                    </div>
                    <div class="category-content">
                        <!-- COMMANDE 1 -->
                        <div class="command-item">
                            <div class="command-meta">
                                <span class="risk-medium">RISQUE MOYEN</span>
                                <span class="category-tag">GESTION</span>
                                <span class="time-tag">‚è±Ô∏è 15 minutes</span>
                            </div>
                            
                            <h3>D√©ploiement IPAM</h3>
                            
                            <pre class="command-code"># Installation IPAM
Install-WindowsFeature IPAM -IncludeManagementTools

# Installer RSAT GPMC pour GPO
Add-WindowsCapability -Online -Name Rsat.GroupPolicy.Management.Tools~~~~0.0.1.0

# Provisionnement IPAM via GPO
Invoke-IpamGpoProvisioning `
    -Domain "afci.lab" `
    -GpoPrefixName "IPAM_AFCI" `
    -IpamServerFqdn "SRV-01.afci.lab"

# D√©marrer la d√©couverte
Start-ScheduledTask -TaskPath "\Microsoft\Windows\IPAM\" -TaskName "ServerDiscovery"</pre>
                            
                            <div class="command-notes">
                                <div class="note note-when">
                                    <div class="note-title">üéØ Quand utiliser</div>
                                    <p>Gestion centralis√©e des adresses IP dans un environnement Windows</p>
                                </div>
                                <div class="note note-warning">
                                    <div class="note-title">‚ö†Ô∏è Attention</div>
                                    <p>La d√©couverte prend plusieurs heures, patientez avant configuration</p>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </section>

            <!-- SECTION ADMINISTRATION √Ä DISTANCE -->
            <section id="remote" class="section">
                <div class="section-header">
                    <h2><i class="fas fa-laptop-house"></i> Administration √† distance</h2>
                    <span class="section-tag">Remote Management</span>
                </div>

                <!-- Cat√©gorie : PowerShell Remoting -->
                <div class="category">
                    <div class="category-header" onclick="toggleCategory(this)">
                        <h3><i class="fas fa-terminal"></i> PowerShell Remoting</h3>
                        <i class="fas fa-chevron-down"></i>
                    </div>
                    <div class="category-content">
                        <!-- COMMANDE 1 -->
                        <div class="command-item">
                            <div class="command-meta">
                                <span class="risk-medium">RISQUE MOYEN</span>
                                <span class="category-tag">REMOTE</span>
                                <span class="time-tag">‚è±Ô∏è 5 minutes</span>
                            </div>
                            
                            <h3>Configurer PowerShell Remoting</h3>
                            
                            <pre class="command-code"># Activer PowerShell Remoting
Enable-PSRemoting -Force

# Autoriser un h√¥te comme TrustedHost
Set-Item WSMan:\localhost\Client\TrustedHosts -Value "IP_PC_ADMIN" -Force

# Configurer WinRM
winrm quickconfig

# Tester la connexion √† un serveur
Enter-PSSession -ComputerName "SRV-01" -Credential (Get-Credential)</pre>
                            
                            <div class="command-notes">
                                <div class="note note-when">
                                    <div class="note-title">üéØ Quand utiliser</div>
                                    <p>Administration √† distance de serveurs</p>
                                </div>
                                <div class="note note-warning">
                                    <div class="note-title">‚ö†Ô∏è Attention</div>
                                    <p>S√©curiser WinRM avec HTTPS dans les environnements de production</p>
                                </div>
                            </div>
                        </div>

                        <!-- COMMANDE 2 -->
                        <div class="command-item">
                            <div class="command-meta">
                                <span class="risk-low">RISQUE FAIBLE</span>
                                <span class="category-tag">REMOTE</span>
                                <span class="time-tag">‚è±Ô∏è 10 secondes</span>
                            </div>
                            
                            <h3>Ex√©cution de commandes √† distance</h3>
                            
                            <pre class="command-code"># Ex√©cuter une commande sur un serveur distant
Invoke-Command -ComputerName "SRV-01" -ScriptBlock {
    Get-Service | Where-Object {$_.Status -eq "Running"}
}

# Cr√©er un partage √† distance
Invoke-Command -ComputerName "SRV-01" -ScriptBlock {
    New-Item -Path "C:\Partages\Test" -ItemType Directory -Force
    New-SmbShare -Name "TestShare" -Path "C:\Partages\Test" -FullAccess "Administrateurs"
}</pre>
                            
                            <div class="command-notes">
                                <div class="note note-when">
                                    <div class="note-title">üéØ Quand utiliser</div>
                                    <p>Administration centralis√©e de plusieurs serveurs</p>
                                </div>
                                <div class="note note-test">
                                    <div class="note-title">‚úÖ Test de succ√®s</div>
                                    <p>La commande s'ex√©cute correctement sur l'h√¥te distant</p>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Cat√©gorie : Jonction au domaine -->
                <div class="category">
                    <div class="category-header" onclick="toggleCategory(this)">
                        <h3><i class="fas fa-network-wired"></i> Jonction au domaine</h3>
                        <i class="fas fa-chevron-down"></i>
                    </div>
                    <div class="category-content">
                        <!-- COMMANDE 1 -->
                        <div class="command-item">
                            <div class="command-meta">
                                <span class="risk-medium">RISQUE MOYEN</span>
                                <span class="category-tag">DOMAINE</span>
                                <span class="time-tag">‚è±Ô∏è 2 minutes</span>
                            </div>
                            
                            <h3>Joindre un ordinateur au domaine</h3>
                            
                            <pre class="command-code"># Joindre un ordinateur au domaine
Add-Computer -DomainName "afci.lab" `
    -Credential (Get-Credential -UserName "AFCI\Administrator") `
    -Restart

# V√©rifier l'appartenance au domaine
(Get-CimInstance Win32_ComputerSystem).Domain

# Renommer et joindre au domaine
Rename-Computer -NewName "PC_Admin" -Force -Restart:$false
Add-Computer -DomainName "afci.lab" -Credential $Creds -Restart</pre>
                            
                            <div class="command-notes">
                                <div class="note note-when">
                                    <div class="note-title">üéØ Quand utiliser</div>
                                    <p>Int√©gration de nouveaux postes dans le domaine</p>
                                </div>
                                <div class="note note-warning">
                                    <div class="note-title">‚ö†Ô∏è Attention</div>
                                    <p>Red√©marrage requis pour que la jonction soit effective</p>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </section>

            <!-- SECTION UTILITAIRES -->
            <section id="utils" class="section">
                <div class="section-header">
                    <h2><i class="fas fa-tools"></i> Utilitaires</h2>
                    <span class="section-tag">Outils</span>
                </div>

                <!-- Cat√©gorie : Commandes Utiles -->
                <div class="category">
                    <div class="category-header" onclick="toggleCategory(this)">
                        <h3><i class="fas fa-terminal"></i> Commandes Utiles</h3>
                        <i class="fas fa-chevron-down"></i>
                    </div>
                    <div class="category-content">
                        <!-- COMMANDE 1 -->
                        <div class="command-item">
                            <div class="command-meta">
                                <span class="risk-low">RISQUE FAIBLE</span>
                                <span class="category-tag">DIAGNOSTIC</span>
                                <span class="time-tag">‚è±Ô∏è 10 secondes</span>
                            </div>
                            
                            <h3>Commandes r√©seau utiles</h3>
                            
                            <pre class="command-code"># Tester la connectivit√©
Test-NetConnection -ComputerName "[HOTE]" -TraceRoute

# V√©rifier les ports ouverts
Test-NetConnection -ComputerName "[HOTE]" -Port [PORT]

# Faire un ping continu
Test-Connection -ComputerName "[HOTE]" -Count 10

# R√©soudre un nom DNS
Resolve-DnsName -Name "[NOM_DOMAINE]"</pre>
                            
                            <div class="command-notes">
                                <div class="note note-when">
                                    <div class="note-title">üéØ Quand utiliser</div>
                                    <p>Diagnostic de probl√®mes r√©seau</p>
                                </div>
                                <div class="note note-warning">
                                    <div class="note-title">‚ö†Ô∏è Attention</div>
                                    <p>Certains h√¥tes peuvent bloquer ICMP ou les scans de port</p>
                                </div>
                                <div class="note note-test">
                                    <div class="note-title">‚úÖ Test de succ√®s</div>
                                    <p>Connectivit√© √©tablie ou probl√®me identifi√©</p>
                                </div>
                            </div>
                        </div>

                        <!-- COMMANDE 2 -->
                        <div class="command-item">
                            <div class="command-meta">
                                <span class="risk-low">RISQUE FAIBLE</span>
                                <span class="category-tag">SYST√àME</span>
                                <span class="time-tag">‚è±Ô∏è 5 secondes</span>
                            </div>
                            
                            <h3>Journal des √©v√©nements</h3>
                            
                            <pre class="command-code"># Voir les √©v√©nements RRAS
Get-EventLog -LogName System -Source RemoteAccess -Newest 20

# V√©rifier l'√©tat du NAT
Get-NetNatStaticMapping
Get-NetNatSession

# V√©rifier les services
Get-Service RemoteAccess | Select-Object Name, Status</pre>
                            
                            <div class="command-notes">
                                <div class="note note-when">
                                    <div class="note-title">üéØ Quand utiliser</div>
                                    <p>D√©pannage de services, investigation d'erreurs</p>
                                </div>
                                <div class="note note-test">
                                    <div class="note-title">‚úÖ Test de succ√®s</div>
                                    <p>Identification de la cause d'un probl√®me</p>
                                </div>
                            </div>
                        </div>

                        <!-- COMMANDE 3 -->
                        <div class="command-item">
                            <div class="command-meta">
                                <span class="risk-low">RISQUE FAIBLE</span>
                                <span class="category-tag">SYST√àME</span>
                                <span class="time-tag">‚è±Ô∏è 5 secondes</span>
                            </div>
                            
                            <h3>Gestion de l'ex√©cution PowerShell</h3>
                            
                            <pre class="command-code"># Modifier la politique d'ex√©cution
Set-ExecutionPolicy -ExecutionPolicy Bypass -Scope Process -Force

# V√©rifier la politique actuelle
Get-ExecutionPolicy -List

# V√©rifier la langue disponible
Get-WinUserLanguageList

# Changer la langue d'affichage
Set-WinUILanguageOverride -Language en-US</pre>
                            
                            <div class="command-notes">
                                <div class="note note-when">
                                    <div class="note-title">üéØ Quand utiliser</div>
                                    <p>Ex√©cution de scripts, configuration syst√®me</p>
                                </div>
                                <div class="note note-warning">
                                    <div class="note-title">‚ö†Ô∏è Attention</div>
                                    <p>Bypass peut √™tre dangereux pour la s√©curit√©</p>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </section>

            <!-- SECTION SCRIPTS COMPLETS -->
            <section id="scripts" class="section">
                <div class="section-header">
                    <h2><i class="fas fa-code"></i> Scripts Complets</h2>
                    <span class="section-tag">Automatisation</span>
                </div>

                <!-- Cat√©gorie : Scripts de Configuration -->
                <div class="category">
                    <div class="category-header" onclick="toggleCategory(this)">
                        <h3><i class="fas fa-cogs"></i> Scripts de Configuration</h3>
                        <i class="fas fa-chevron-down"></i>
                    </div>
                    <div class="category-content">
                        <!-- SCRIPT 1 : Configuration RRAS -->
                        <div class="command-item">
                            <div class="command-meta">
                                <span class="risk-high">RISQUE √âLEV√â</span>
                                <span class="category-tag">ROUTAGE</span>
                                <span class="time-tag">‚è±Ô∏è 5 minutes</span>
                            </div>
                            
                            <h3>Script complet : Configuration RRAS avec NAT</h3>
                            
                            <pre class="command-code"># Script complet de configuration RRAS avec NAT
# ============================================

# 1. Installer les r√¥les n√©cessaires
Install-WindowsFeature RemoteAccess, Routing -IncludeManagementTools
Restart-Computer -Force

# 2. Activer le service RRAS
Install-RemoteAccess -VpnType RoutingOnly

# 3. D√©marrer et configurer le service
Set-Service RemoteAccess -StartupType Automatic
Start-Service RemoteAccess

# 4. Configurer les interfaces (exemple pour RT1)
# Interface WAN (vers Internet)
New-NetIPAddress -InterfaceIndex 1 -IPAddress 172.16.2.141 -PrefixLength 28 -DefaultGateway 172.16.2.142

# Interface LAN (utilisateurs)
New-NetIPAddress -InterfaceIndex 2 -IPAddress 172.16.1.254 -PrefixLength 24

# Interface Serveurs
New-NetIPAddress -InterfaceIndex 5 -IPAddress 172.16.2.62 -PrefixLength 26

# 5. Configurer les routes statiques
New-NetRoute -DestinationPrefix "172.16.0.0/24" -NextHop "172.16.2.140" -InterfaceIndex 2
New-NetRoute -DestinationPrefix "172.16.2.0/26" -NextHop "172.16.2.140" -InterfaceIndex 2

# 6. Activer le forwarding IP
Set-NetIPInterface -InterfaceAlias "Ethernet" -Forwarding Enabled
Set-NetIPInterface -InterfaceAlias "Ethernet 2" -Forwarding Enabled

# 7. Configurer DHCP Relay (optionnel)
netsh routing ip relay install
netsh routing ip relay add dhcpserver 172.16.2.1

# 8. Activer les r√®gles de pare-feu n√©cessaires
Enable-NetFirewallRule -DisplayGroup "File and Printer Sharing"
Enable-NetFirewallRule -DisplayGroup "Remote Service Management"

Write-Host "Configuration RRAS termin√©e avec succ√®s!" -ForegroundColor Green</pre>
                            
                            <div class="command-notes">
                                <div class="note note-when">
                                    <div class="note-title">üéØ Quand utiliser</div>
                                    <p>Configuration compl√®te d'un serveur comme routeur avec NAT</p>
                                </div>
                                <div class="note note-warning">
                                    <div class="note-title">‚ö†Ô∏è Attention</div>
                                    <p>Adapter les adresses IP et interfaces selon votre topologie</p>
                                </div>
                                <div class="note note-test">
                                    <div class="note-title">‚úÖ Test de succ√®s</div>
                                    <p>Le trafic passe entre les r√©seaux et NAT fonctionne</p>
                                </div>
                            </div>
                        </div>

                        <!-- SCRIPT 2 : Promotion DC r√©pliqu√© -->
                        <div class="command-item">
                            <div class="command-meta">
                                <span class="risk-high">RISQUE √âLEV√â</span>
                                <span class="category-tag">ACTIVE DIRECTORY</span>
                                <span class="time-tag">‚è±Ô∏è 10-30 minutes</span>
                            </div>
                            
                            <h3>Script complet : Promotion en DC r√©pliqu√©</h3>
                            
                            <pre class="command-code"># Script complet pour promouvoir SRV-03 en DC r√©pliqu√©
# ======================================================

# Variables de configuration
$ServerName = "SRV-03"
$DomainName = "afci.lab"
$DomainNetbios = "AFCI"
$ServerIP = "172.16.2.65"
$ServerGateway = "172.16.2.126"
$PrimaryDNS = "172.16.2.1"
$SecondaryDNS = "8.8.8.8"

# 1. Configuration r√©seau
$Adapter = Get-NetAdapter -Physical | Where-Object {$_.Status -eq 'Up'} | Select-Object -First 1
Set-NetIPInterface -InterfaceIndex $Adapter.InterfaceIndex -Dhcp Disabled
New-NetIPAddress -InterfaceIndex $Adapter.InterfaceIndex `
    -IPAddress $ServerIP `
    -PrefixLength 26 `
    -DefaultGateway $ServerGateway
Set-DnsClientServerAddress -InterfaceIndex $Adapter.InterfaceIndex `
    -ServerAddresses @($PrimaryDNS, $SecondaryDNS)

# 2. Renommage du serveur
Rename-Computer -NewName $ServerName -Force -Restart:$false

# 3. Jonction au domaine (si n√©cessaire)
$CurrentDomain = (Get-CimInstance Win32_ComputerSystem).Domain
if ($CurrentDomain -ne $DomainName) {
    $Creds = Get-Credential -UserName "$DomainNetbios\Administrator"
    Add-Computer -DomainName $DomainName -Credential $Creds -Force -Restart
    exit 0
}

# 4. Installation des r√¥les AD
Install-WindowsFeature AD-Domain-Services, DNS -IncludeManagementTools

# 5. D√©couverte du DC existant
$SourceDC_FQDN = (Resolve-DnsName -Name $PrimaryDNS -Type PTR).NameHost
if ([string]::IsNullOrEmpty($SourceDC_FQDN)) {
    $SourceDC_FQDN = "SRV-01.$DomainName"
}

# 6. Promotion en DC r√©pliqu√©
$SafeModePwd = Read-Host -AsSecureString -Prompt "Mot de passe SAFE MODE"
$PromotionCreds = Get-Credential -UserName "$DomainNetbios\Administrator"

Install-ADDSDomainController `
    -DomainName $DomainName `
    -SafeModeAdministratorPassword $SafeModePwd `
    -Credential $PromotionCreds `
    -InstallDns `
    -NoGlobalCatalog:$false `
    -SiteName "Default-First-Site-Name" `
    -ReplicationSourceDC $SourceDC_FQDN `
    -CreateDnsDelegation:$false `
    -NoRebootOnCompletion:$false `
    -Force

Write-Host "Promotion r√©ussie! Red√©marrage en cours..." -ForegroundColor Green</pre>
                            
                            <div class="command-notes">
                                <div class="note note-when">
                                    <div class="note-title">üéØ Quand utiliser</div>
                                    <p>Ajout d'un contr√¥leur de domaine r√©pliqu√© dans un domaine existant</p>
                                </div>
                                <div class="note note-warning">
                                    <div class="note-title">‚ö†Ô∏è Attention</div>
                                    <p>Op√©ration irr√©versible, n√©cessite un red√©marrage</p>
                                </div>
                                <div class="note note-test">
                                    <div class="note-title">‚úÖ Test de succ√®s</div>
                                    <p>`repadmin /replsummary` montre une r√©plication saine</p>
                                </div>
                            </div>
                        </div>

                        <!-- SCRIPT 3 : Configuration DHCP Failover -->
                        <div class="command-item">
                            <div class="command-meta">
                                <span class="risk-medium">RISQUE MOYEN</span>
                                <span class="category-tag">DHCP</span>
                                <span class="time-tag">‚è±Ô∏è 5 minutes</span>
                            </div>
                            
                            <h3>Script complet : Configuration DHCP Failover</h3>
                            
                            <pre class="command-code"># Script de configuration DHCP Failover entre SRV-01 et SRV-03
# =============================================================

# 1. Installer le r√¥le DHCP sur SRV-03 (si n√©cessaire)
Install-WindowsFeature -Name DHCP -IncludeManagementTools

# 2. Autoriser le service dans le pare-feu
netsh advfirewall firewall add rule name="DHCP Server" dir=in action=allow protocol=UDP localport=67,68

# 3. Red√©marrer le service
Restart-Service DHCPServer -Force
Set-Service -Name DHCPServer -StartupType Automatic

# 4. Configuration du failover pour le scope Lille
Add-DhcpServerv4Failover `
    -Name "Failover-Lille-Scope" `
    -ScopeId 172.16.0.0 `
    -PartnerServer "SRV-03.afci.lab" `
    -ComputerName "SRV-01.afci.lab" `
    -LoadBalancePercent 50 `
    -MaxClientLeadTime 01:00:00

# 5. Configuration du failover pour le scope Arras
Add-DhcpServerv4Failover `
    -Name "Failover-Arras-Scope" `
    -ScopeId 172.16.1.0 `
    -PartnerServer "SRV-03.afci.lab" `
    -ComputerName "SRV-01.afci.lab" `
    -LoadBalancePercent 50 `
    -MaxClientLeadTime 01:00:00

# 6. V√©rification des scopes
Write-Host "=== Scopes sur SRV-01 ===" -ForegroundColor Cyan
Get-DhcpServerv4Scope -ComputerName "SRV-01.afci.lab" | Format-Table ScopeId, Name, State

Write-Host "`n=== Scopes sur SRV-03 ===" -ForegroundColor Cyan
Get-DhcpServerv4Scope -ComputerName "SRV-03.afci.lab" | Format-Table ScopeId, Name, State

Write-Host "`n=== √âtat du failover ===" -ForegroundColor Cyan
Get-DhcpServerv4Failover -ComputerName "SRV-01.afci.lab" | Format-Table Name, PartnerServer, Mode

Write-Host "`nConfiguration DHCP Failover termin√©e avec succ√®s!" -ForegroundColor Green</pre>
                            
                            <div class="command-notes">
                                <div class="note note-when">
                                    <div class="note-title">üéØ Quand utiliser</div>
                                    <p>Mise en place de haute disponibilit√© pour le service DHCP</p>
                                </div>
                                <div class="note note-warning">
                                    <div class="note-title">‚ö†Ô∏è Attention</div>
                                    <p>Les deux serveurs doivent √™tre dans le m√™me domaine</p>
                                </div>
                                <div class="note note-test">
                                    <div class="note-title">‚úÖ Test de succ√®s</div>
                                    <p>Les clients re√ßoivent des adresses m√™me si un serveur DHCP est down</p>
                                </div>
                            </div>
                        </div>

                        <!-- SCRIPT 4 : Configuration IPAM -->
                        <div class="command-item">
                            <div class="command-meta">
                                <span class="risk-medium">RISQUE MOYEN</span>
                                <span class="category-tag">GESTION</span>
                                <span class="time-tag">‚è±Ô∏è 15 minutes</span>
                            </div>
                            
                            <h3>Script complet : D√©ploiement IPAM</h3>
                            
                            <pre class="command-code"># Script de d√©ploiement IPAM en mode production (GPO)
# ====================================================

# 1. Installation IPAM
Install-WindowsFeature IPAM -IncludeManagementTools
Restart-Computer

# 2. Installer RSAT GPMC pour GPO
Add-WindowsCapability -Online -Name Rsat.GroupPolicy.Management.Tools~~~~0.0.1.0
Add-WindowsCapability -Online -Name Rsat.ActiveDirectory.DS-LDS.Tools~~~~0.0.1.0

# 3. Importer les modules
Import-Module GroupPolicy
Import-Module ActiveDirectory
Import-Module IpamServer

# 4. Provisionnement IPAM via GPO
Invoke-IpamGpoProvisioning `
    -Domain "afci.lab" `
    -GpoPrefixName "IPAM_AFCI" `
    -IpamServerFqdn "SRV-01.afci.lab"

# 5. D√©marrer la d√©couverte
Start-ScheduledTask -TaskPath "\Microsoft\Windows\IPAM\" -TaskName "ServerDiscovery"

# 6. Attendre la d√©couverte (2-4 heures)
Write-Host "D√©couverte en cours (2 √† 4 heures)..." -ForegroundColor Yellow
Write-Host "Les serveurs DC/DHCP/DNS seront d√©couverts automatiquement" -ForegroundColor White

# 7. V√©rifier l'√©tat de d√©couverte (apr√®s attente)
Write-Host "`n=== √âtat des serveurs d√©couverts ===" -ForegroundColor Cyan
Get-IpamServerInventory | Format-Table ServerFqdn, ServiceType, ManageabilityStatus

# 8. Configuration de la structure r√©seau (post-d√©couverte)
Add-IpamBlock -NetworkId "172.16.0.0/16" -Description "Infrastructure AFCI" -Owner "IT-AFCI"

Add-IpamSubnet -NetworkId "172.16.0.0/24" -SubnetName "Lille-Users" -Site "Lille" -Description "Utilisateurs Lille"
Add-IpamSubnet -NetworkId "172.16.1.0/24" -SubnetName "Arras-Users" -Site "Arras" -Description "Utilisateurs Arras"
Add-IpamSubnet -NetworkId "172.16.2.0/26" -SubnetName "Infra-Serveurs" -Description "R√©seau Serveurs-Lille"
Add-IpamSubnet -NetworkId "172.16.2.64/26" -SubnetName "Infra-Serveurs" -Description "R√©seau Serveurs-Arras"
Add-IpamSubnet -NetworkId "172.16.2.128/28" -SubnetName "Infra-Serveurs" -Description "R√©seau interconnexion"

Write-Host "`nIPAM d√©ploy√© avec succ√®s!" -ForegroundColor Green</pre>
                            
                            <div class="command-notes">
                                <div class="note note-when">
                                    <div class="note-title">üéØ Quand utiliser</div>
                                    <p>Gestion centralis√©e des adresses IP dans un environnement Windows</p>
                                </div>
                                <div class="note note-warning">
                                    <div class="note-title">‚ö†Ô∏è Attention</div>
                                    <p>La d√©couverte prend plusieurs heures, patientez avant configuration</p>
                                </div>
                                <div class="note note-test">
                                    <div class="note-title">‚úÖ Test de succ√®s</div>
                                    <p>Les serveurs apparaissent dans la console IPAM</p>
                                </div>
                            </div>
                        </div>

                        <!-- SCRIPT 5 : Configuration Windows LAPS -->
                        <div class="command-item">
                            <div class="command-meta">
                                <span class="risk-high">RISQUE √âLEV√â</span>
                                <span class="category-tag">S√âCURIT√â</span>
                                <span class="time-tag">‚è±Ô∏è 15 minutes</span>
                            </div>
                            
                            <h3>Script complet : D√©ploiement Windows LAPS</h3>
                            
                            <pre class="command-code"># Script de d√©ploiement Windows LAPS
# Domaine : afci.lab
# OU cible : OU=Ordinateurs,DC=afci,DC=lab
# =============================================

# 1. Installer le module LAPS
Get-WindowsCapability -Name RSAT*LAPS* -Online
Add-WindowsCapability -Online -Name Rsat.Laps.Tools~~~~0.0.1.0

Import-Module LAPS
Import-Module GroupPolicy

# Variables
$DomainOU        = "OU=Ordinateurs,DC=afci,DC=lab"
$GPOName         = "GPO-SEC-Windows-LAPS-Ordinateurs"
$LAPSRegistryKey = "HKLM\Software\Microsoft\Policies\LAPS"
$LAPSReaders     = "GG_IT_Admin"

# 2. Mise √† jour du sch√©ma Active Directory (1 seule fois)
Update-LapsADSchema

# 3. Autoriser les ordinateurs √† √©crire leur mot de passe
Set-LapsADComputerSelfPermission -Identity $DomainOU

# 4. D√©l√©gation de lecture des mots de passe LAPS
Set-LapsADReadPasswordPermission `
    -Identity $DomainOU `
    -AllowedPrincipals $LAPSReaders

# 5. Cr√©ation de la GPO LAPS
if (-not (Get-GPO -Name $GPOName -ErrorAction SilentlyContinue)) {
    New-GPO -Name $GPOName -Comment "Gestion automatique des mots de passe admin locaux via Windows LAPS"
}

# 6. Lier la GPO √† l'OU Ordinateurs
New-GPLink `
    -Name $GPOName `
    -Target $DomainOU `
    -LinkEnabled Yes

# 7. Configuration LAPS via registre
Set-GPRegistryValue -GpoName $GPOName -Key $LAPSRegistryKey `
    -ValueName "BackupDirectory" -Type DWord -Value 1

Set-GPRegistryValue -GpoName $GPOName -Key $LAPSRegistryKey `
    -ValueName "PasswordAgeDays" -Type DWord -Value 30

Set-GPRegistryValue -GpoName $GPOName -Key $LAPSRegistryKey `
    -ValueName "PasswordLength" -Type DWord -Value 14

Set-GPRegistryValue -GpoName $GPOName -Key $LAPSRegistryKey `
    -ValueName "PasswordComplexity" -Type DWord -Value 4

Set-GPRegistryValue -GpoName $GPOName -Key $LAPSRegistryKey `
    -ValueName "AdminAccountName" -Type String -Value "Administrator"

Set-GPRegistryValue -GpoName $GPOName -Key $LAPSRegistryKey `
    -ValueName "EnablePasswordEncryption" -Type DWord -Value 1

Write-Host "=== D√©ploiement Windows LAPS termin√© avec succ√®s ===" -ForegroundColor Green</pre>
                            
                            <div class="command-notes">
                                <div class="note note-when">
                                    <div class="note-title">üéØ Quand utiliser</div>
                                    <p>S√©curisation des mots de passe administrateur locaux</p>
                                </div>
                                <div class="note note-warning">
                                    <div class="note-title">‚ö†Ô∏è Attention</div>
                                    <p>N√©cessite des droits d'administrateur d'entreprise</p>
                                </div>
                                <div class="note note-test">
                                    <div class="note-title">‚úÖ Test de succ√®s</div>
                                    <p>Les mots de passe administrateur sont automatiquement g√©r√©s</p>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </section>

            <!-- FOOTER -->
            <footer class="footer">
                <p>Base de connaissances Windows Compl√®te Maintenu par l'√©quipe d'administration syst√®me</p>
                <p style="margin-top: 10px; font-size: 0.9rem;">
                    Derni√®re mise √† jour : <span id="currentDate"></span> ‚Ä¢ Contient toutes les commandes des fichiers TP
                </p>
            </footer>
        </main>
    </div>

    <script>
        // Date actuelle
        document.getElementById('currentDate').textContent = new Date().toLocaleDateString('fr-FR', {
            year: 'numeric',
            month: 'long',
            day: 'numeric'
        });

        // Fonction de pliage/d√©pliage
        function toggleCategory(header) {
            const content = header.nextElementSibling;
            const icon = header.querySelector('i.fa-chevron-down');
            
            content.classList.toggle('collapsed');
            icon.classList.toggle('rotated');
        }

        // Tout d√©plier
        document.getElementById('expandAllBtn').addEventListener('click', function() {
            document.querySelectorAll('.category-content').forEach(content => {
                content.classList.remove('collapsed');
            });
            document.querySelectorAll('.category-header i.fa-chevron-down').forEach(icon => {
                icon.classList.add('rotated');
            });
        });

        // Tout replier
        document.getElementById('collapseAllBtn').addEventListener('click', function() {
            document.querySelectorAll('.category-content').forEach(content => {
                content.classList.add('collapsed');
            });
            document.querySelectorAll('.category-header i.fa-chevron-down').forEach(icon => {
                icon.classList.remove('rotated');
            });
        });

        // Recherche
        document.getElementById('searchInput').addEventListener('input', function(e) {
            const searchTerm = e.target.value.toLowerCase();
            const commands = document.querySelectorAll('.command-item');
            
            commands.forEach(cmd => {
                const text = cmd.textContent.toLowerCase();
                if (text.includes(searchTerm)) {
                    cmd.style.display = 'block';
                    // D√©plier la cat√©gorie parente
                    const category = cmd.closest('.category');
                    const categoryContent = category.querySelector('.category-content');
                    const categoryIcon = category.querySelector('.category-header i.fa-chevron-down');
                    
                    if (categoryContent.classList.contains('collapsed')) {
                        categoryContent.classList.remove('collapsed');
                        categoryIcon.classList.add('rotated');
                    }
                    
                    category.style.display = 'block';
                } else {
                    cmd.style.display = 'none';
                }
            });
            
            // Cacher les cat√©gories vides
            document.querySelectorAll('.category').forEach(category => {
                const visibleCommands = category.querySelectorAll('.command-item[style="display: block"]');
                if (visibleCommands.length === 0) {
                    category.style.display = 'none';
                } else {
                    category.style.display = 'block';
                }
            });
        });

        // Navigation
        document.querySelectorAll('.nav-links a').forEach(link => {
            link.addEventListener('click', function(e) {
                e.preventDefault();
                
                // Mettre √† jour l'actif
                document.querySelectorAll('.nav-links a').forEach(a => a.classList.remove('active'));
                this.classList.add('active');
                
                // Scroll
                const targetId = this.getAttribute('href');
                const targetElement = document.querySelector(targetId);
                if (targetElement) {
                    window.scrollTo({
                        top: targetElement.offsetTop - 20,
                        behavior: 'smooth'
                    });
                }
            });
        });
    </script>
</body>
</html>